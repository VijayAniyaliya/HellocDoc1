@model Services.Models.AdminProfileViewModel

@{
    ViewData["Title"] = "AdminProfile";
    Layout = "~/Views/Shared/_AdminDashboardLayout.cshtml";
}

<div class="container">
    <div class="d-flex justify-content-between pt-3">
        <h4>My Profile</h4>
        <a asp-area="" asp-action="AdminDashboard" class="btn border-2 border-info text-info p-2 px-3 fw-bold">
            &lt;  Back
        </a>

    </div>
    <div class="px-3 pt-4 shadow rounded-3 Document-content mt-3" style="">
        <div class="h4 mb-4">Account Information</div>
        <div class="row">
            <div class="col-md-6">
                <div class="form-floating mb-3">
                    <input type="text" asp-for="Username" class="form-control account" id="floatingInput"
                           placeholder="username" disabled />
                    <label for="floatingInput" class="">Username</label>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-floating mb-3">
                    <input type="text" class="form-control account" id="password"
                           placeholder="password" />
                    <label for="password" class="">Password</label>
                    <span id="passwarn" class="text-danger"></span>

                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="form-floating">
                    <select class="form-select account" asp-for="Status" id="floatingSelect" aria-label="Floating label select example" disabled>
                        <option selected>Active</option>
                        <option value="1">UnActive</option>
                        <option value="2">UnAvailable</option>
                    </select>
                    <label for="floatingSelect">Status</label>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-floating">
                    <select class="form-select account" asp-for="Role" id="floatingSelect" aria-label="Floating label select example" disabled>
                        <option selected>Master Admin</option>
                        <option value="1">Admin</option>
                    </select>
                    <label for="floatingSelect">Role</label>
                </div>
            </div>
            <div class="text-end mt-4">
                <button type="button" id="reset" onclick="resetpass()" class="btn border-info text-info h5">Reset Password</button>

            </div>

            <div class="h4 mb-4">Administrator Information</div>
            <form class="row">

                <div class="col-md-6">
                    <div class="form-floating mb-3">
                        <input type="text" asp-for="FirstName" class="form-control administrator" id="firstname"
                               placeholder="first name" disabled />
                        <label for="firstname" class="">First Name</label>
                        <span id="firstwarning" class="text-danger common"></span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-floating mb-3">
                        <input type="text" asp-for="LastName" class="form-control administrator" id="lastname"
                               placeholder="last name" disabled />
                        <label for="lastname" class="">Last Name</label>
                        <span id="lastwarning" class="text-danger common"></span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-floating mb-3">
                        <input type="email" asp-for="Email" class="form-control administrator" id="email"
                               placeholder="abc@gmail.com" disabled />
                        <label for="email" class="">Email</label>
                        <span id="emailwarning" class="text-danger common"></span>

                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-floating mb-3">
                        <input type="email" asp-for="ConfirmEmail" class="form-control administrator" id="confirmemail"
                               placeholder="abc@gmail.com" disabled />
                        <label for="confirmemail" class="">Confirm Email</label>
                        <span id="confirmemailwarning" class="text-danger common"></span>

                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-floating  mb-3">
                        <input type="tel" asp-for="PhoneNumber" class="form-control pt-3 pb-3 administrator" id="phone" disabled>
                        <span id="phonewarning" class="text-danger common"></span>

                    </div>
                </div>
                <div class="col-12 col-md-6 mt-3">
                    @foreach (var item in Model.RegionList)
                    {
                        <div class="form-check form-check-inline ">
                            <input class="form-check-input adisabled adminselectedregion-adminprofile data" type="checkbox"
                            @if (Model.AdminRegionList.Any(adminRegion => adminRegion.RegionId == item.RegionId))
                            {
                                @:checked
                            } value="@item.RegionId" disabled>
                            <label class="form-check-label" for="inlineCheckbox1">@item.Name</label>
                        </div>
                    }
                </div>
                <div class="d-flex justify-content-end gap-3 mt-2">
                    <button type="button" id="edit" class="btn bg-info text-white px-4 h5">Edit</button>
                    <button type="button" id="savedata" onclick="updatedata()" class="btn bg-info text-white rounded-3 fw-bold px-4 h5 modify">Save Changes</button>
                    <button type="reset" id="cancel" class="btn bg-white text-info border-2  border-info rounded-3 fw-bold h5 modify">Cancel</button>

                </div>
            </form>
            <form class="row">
                <div class="h4 mb-4">Mailing & Billing information</div>

                <div class="col-md-6">
                    <div class="form-floating mb-3">
                        <input type="text" asp-for="Address1" class="form-control billing" id="address1"
                               placeholder="address 1" disabled />
                        <label for="address1" class="">Address 1</label>
                        <span id="address1warning" class="text-danger billwarning"></span>

                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-floating mb-3">
                        <input type="text" asp-for="Address2" class="form-control billing" id="address2"
                               placeholder="address 2" disabled />
                        <label for="address2" class="">Address 2</label>
                        <span id="address2warning" class="text-danger billwarning"></span>

                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-floating mb-3">
                        <input type="text" asp-for="City" class="form-control billing" id="city"
                               placeholder="city" disabled />
                        <label for="city" class="">City</label>
                        <span id="citywarning" class="text-danger billwarning"></span>

                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-floating mb-3">
                        <input type="text" asp-for="State" class="form-control billing" id="state"
                               placeholder="state" disabled />
                        <label for="state" class="">State</label>
                        <span id="statewarning" class="text-danger billwarning"></span>

                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-floating mb-3">
                        <input type="text" asp-for="Zip" class="form-control billing" id="zip"
                               placeholder="zipcode" disabled />
                        <label for="zip" class="">Zip</label>
                        <span id="zipwarning" class="text-danger billwarning"></span>

                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-floating  mb-3">
                        <input type="tel" asp-for="AltPhoneNumber" class="form-control pt-3 pb-3 billing" id="phone1" disabled>
                        <span id="phone1warning" class="text-danger billwarning"></span>

                    </div>
                </div>
                <div class="d-flex justify-content-end gap-3 mt-2">
                    <button type="button" id="editbill" class="btn bg-info text-white px-4 h5">Edit</button>
                    <button type="button" id="Billingdata" onclick="billingdata()" class="btn bg-info text-white rounded-3  fw-bold px-4 h5 modifybill">Save Changes</button>
                    <button type="reset" id="cancelbill" class="btn bg-white text-info border-2  border-info rounded-3 fw-bold h5 modifybill">Cancel</button>

                </div>
            </form>


        </div>
        <br />
        <br />

    </div>
</div>
<br />
<br />
<br />
<br />

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

<script>


    function resetpass() {
        var password = $('#password').val();
        if(password == ""){
            $('#passwarn').html("Please enter password")
        }
        else {
            $.ajax({
            url: "/Admin/ResetPassword/",
            type: "POST",
            async: false,
            data: { "password": password },
            dataType: "html",
            success: function (data) {
                toastr.success('Password Reset Successfully');
                $('#password').val("")
            },
            error: function () {
                alert("No Projects Found");
                console.log('error');
            }
        });
        $('#passwarn').html("")
      }
    };


    $('.modify').each(function () {
        $(this).css('display', 'none');
    })
    $('.modifybill').each(function () {
        $(this).css('display', 'none');
    })
    $('#edit').on('click', function () {
        $('.administrator').each(function () {
            $(this).prop('disabled', false);
        })
        $('.data').each(function () {
            $(this).prop('disabled', false);
        })
        $('.modify').each(function () {
            $(this).css('display', 'flex');
        })
        $(this).css('display', 'none');
    })
    $('#cancel').on('click', function () {
        $('.administrator').each(function () {
            $(this).prop('disabled', true);
        })
        $('.data').each(function () {
            $(this).prop('disabled', true);
        })
        $('.modify').each(function () {
            $(this).css('display', 'none');
        })
        $('#edit').css('display', 'flex')
        $('.common').html('');
    })
    $('#editbill').on('click', function () {
        $('.billing').each(function () {
            $(this).prop('disabled', false);
        })
        $('.modifybill').each(function () {
            $(this).css('display', 'flex');
        })
        $(this).css('display', 'none');
    })
    $('#cancelbill').on('click', function () {
        $('.billing').each(function () {
            $(this).prop('disabled', true);
        })
        $('.modifybill').each(function () {
            $(this).css('display', 'none');
        })
        $('#editbill').css('display', 'flex');
        $('.billwarning').html('');

    })

    var RegionSelected = [];

    function updatedata() {
        $('.data:checked').each(function () {
            RegionSelected.push($(this).val());
        });
        console.log(RegionSelected);
        var formdata = {
            firstname: $('#firstname').val(),
            lastname: $('#lastname').val(),
            email: $('#email').val(),
            phonenumber: $('#phone').val(),
            RegionSelected: RegionSelected,
        }
        console.log(formdata);
        console.log(formdata.RegionSelected);
        if ((formdata.firstname != "") && (formdata.lastname != "") && (formdata.email != "") && (formdata.phonenumber != "")) {

            $.ajax({
                url: "/Admin/UpdateAdminstrator/",
                type: "POST",
                data: formdata,
                dataType: "json",
                async: false,

                success: function (data) {
                    console.log("form data")

                    $('#edit').css('display', 'flex');
                    $('.data').each(function () {
                        $(this).prop('disabled', false);
                    })
                    $('.modify').each(function () {
                        $(this).css('display', 'none');
                    })
                    $('.administrator').each(function () {
                        $(this).prop('disabled', true);
                    })
                    window.location.reload();
                },
                error: function (error) {
                    alert("No Projects Found");
                    console.log(error);
                }
            });
            $('#firstwarning').html("");
            $('#lastwarning').html("");
            $('#emailwarning').html("");
            $('#phonewarning').html("");
        }
        else {
            console.log("denied")
        }
    };
    function billingdata() {
        var billdata = {
            address1: $('#address1').val(),
            address2: $('#address2').val(),
            city: $('#city').val(),
            zip: $('#zip').val(),
            altphonenumber: $('#phone1').val(),

        }
        console.log(billdata);
        if ((billdata.address1 != "") && (billdata.address2 != "") && (billdata.city != "") && (billdata.zip != "") && (billdata.altphonenumber != "")) {

            $.ajax({
                url: "/Admin/UpdateBillInfo/",
                type: "POST",
                data: billdata,
                async: false,
                dataType: "html",
                success: function (data) {
                    console.log("billing info");

                },
                error: function (error) {
                    alert("No Projects Found");
                    console.log(error);
                }
            });
            $('#Billingdata').css('display', 'flex');
            $('.modifybill').css('display', 'none');
            $('.billing').each(function () {
                $(this).prop('disabled', true);
            })
            $('#address1warning').html("");
            $('#address2warning').html("");
            $('#citywarning').html("");
            $('#zipwarning').html("");
            $('#altphonenumberwarning').html("");
        }
        else {
            console.log("denied")
        }

    };


    $('#password').on('input', function () {
        if ($('#password').val() == "") {
            $('#passwarn').html("Please enter password")
        }
        else {
            $('#passwarn').html("")
        }
    })
    $('#firstname').on('input', function () {
        if ($('#firstname').val() == "") {
            $('#firstwarning').html("Please enter First name")
        }
        else {
            $('#firstwarning').html("")
        }
    })
    $('#lastname').on('input', function () {
        if ($('#lastname').val() == "") {
            $('#lastwarning').html("Please enter Last name")
        }
        else {
            $('#lastwarning').html("")
        }
    })
    $('#email').on('input', function () {
        if ($('#email').val() == "") {
            $('#emailwarning').html("Please enter Email")
        }
        else {
            $('#emailwarning').html("")
        }
    })
    $('#confirmemail').on('input', function () {
        if ($('#confirmemail').val() == "") {
            $('#confirmemailwarning').html("Please enter Confirm Email")
        }
        else if ($('#confirmemail').val() != $('#email').val()) {
            $('#confirmemailwarning').html("Email and Confirm Email must be match")
        }
        else {
            $('#confirmemailwarning').html("")
        }
    })
    $('#phone').on('input', function () {
        if ($('#phone').val() == "") {
            $('#phonewarning').html("Please enter Phone Number")
        }
        else {
            $('#phonewarning').html("")
        }
    })
    $('#address1').on('input', function () {
        if ($('#address1').val() == "") {
            $('#address1warning').html("Please enter Address1")
        }
        else {
            $('#address1warning').html("")
        }
    })
    $('#address2').on('input', function () {
        if ($('#address2').val() == "") {
            $('#address2warning').html("Please enter Address2")
        }
        else {
            $('#address2warning').html("")
        }
    })
    $('#city').on('input', function () {
        if ($('#city').val() == "") {
            $('#citywarning').html("Please enter City")
        }
        else {
            $('#citywarning').html("")
        }
    })
    // $('#state').on('input', function () {
    //     if ($('#state').val() == "") {
    //         $('#statewarning').html("Please enter First name")
    //     }
    //     else {
    //         $('#statewarning').html("")
    //     }
    // })
    $('#zip').on('input', function () {
        if ($('#zip').val() == "") {
            $('#zipwarning').html("Please enter Zip Code")
        }
        else {
            $('#zipwarning').html("")
        }
    })
    $('#phone1').on('input', function () {
        if ($('#phone1').val() == "") {
            $('#phone1warning').html("Please enter Alternative Phone Number")
        }
        else {
            $('#phone1warning').html("")
        }
    })

    const phoneInputField = document.querySelector("#phone");
    const phoneInput = window.intlTelInput(phoneInputField, {
        utilsScript:
            "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
    });
    const phone1InputField = document.querySelector("#phone1");
    const phone1Input = window.intlTelInput(phone1InputField, {
        utilsScript:
            "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
    });
</script>